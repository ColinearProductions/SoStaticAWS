gcloud auth login

gcloud config set project sostaticgcp

docker build -t gcp_server .   //create docker image. IF image already exists( mongo, nginx) skip this step

docker tag gcp_server eu.gcr.io/sostaticgcp/server:latest  //tag the image

docker push eu.gcr.io/sostaticgcp/server:latest     // push to gcp registry


gcloud compute instances create-with-container server --container-image eu.gcr.io/sostaticgcp/server:latest --zone europe-west6-a --container-env-file ./enviroment.env --container-mount-host-path host-path=nginx/certbot-etc,mount-path=/etc/letsencrypt,mode=rw --container-mount-host-path host-path=nginx/certbot-var,mount-path=/var/lib/letsencrypt,mode=rw --container-mount-host-path host-path=nginx/web-root,mount-path=/var/www/html,mode=rw --container-mount-host-path host-path=nginx/certbot-logs,mount-path=/var/log/letsencrypt/,mode=rw

--no-address # for server - no public address



gcloud compute ssh server // ssh into server instance


gcloud compute instances update-container server --container-image eu.gcr.io/sostaticgcp/server:latest --zone europe-west6-a


docker exec -it [docker ps / name] /bin/bash  // ssh into container
