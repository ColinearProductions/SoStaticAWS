{"remainingRequest":"C:\\Users\\Colinear\\Dropbox\\Workspace\\Web\\VueSoStatic\\vue-SoStatic\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\Colinear\\Dropbox\\Workspace\\Web\\VueSoStatic\\vue-SoStatic\\node_modules\\eslint-loader\\index.js??ref--18-0!C:\\Users\\Colinear\\Dropbox\\Workspace\\Web\\VueSoStatic\\vue-SoStatic\\src\\firebase_api.js","dependencies":[{"path":"C:\\Users\\Colinear\\Dropbox\\Workspace\\Web\\VueSoStatic\\vue-SoStatic\\src\\firebase_api.js","mtime":1535816947094},{"path":"C:\\Users\\Colinear\\Dropbox\\Workspace\\Web\\VueSoStatic\\vue-SoStatic\\package.json","mtime":1535811265818},{"path":"C:\\Users\\Colinear\\Dropbox\\Workspace\\Web\\VueSoStatic\\vue-SoStatic\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1524914320675},{"path":"C:\\Users\\Colinear\\Dropbox\\Workspace\\Web\\VueSoStatic\\vue-SoStatic\\node_modules\\babel-loader\\lib\\index.js","mtime":1519636541000},{"path":"C:\\Users\\Colinear\\Dropbox\\Workspace\\Web\\VueSoStatic\\vue-SoStatic\\node_modules\\eslint-loader\\index.js","mtime":1519638534000}],"contextDependencies":[],"result":["import _typeof from \"C:\\\\Users\\\\Colinear\\\\Dropbox\\\\Workspace\\\\Web\\\\VueSoStatic\\\\vue-SoStatic\\\\node_modules\\\\@babel\\\\runtime/helpers/typeof\";\nimport firebase from 'firebase';\nimport 'firebase/firestore';\nvar settings = {\n  /* your settings... */\n  timestampsInSnapshots: true\n};\nvar config = {\n  apiKey: \"AIzaSyDOpoNcoeSWE8weaKuT8DvMWt2qSTok11k\",\n  authDomain: \"sostatic-1d381.firebaseapp.com\",\n  databaseURL: \"https://sostatic-1d381.firebaseio.com\",\n  projectId: \"sostatic-1d381\",\n  storageBucket: \"sostatic-1d381.appspot.com\",\n  messagingSenderId: \"446439468118\"\n};\nfirebase.initializeApp(config);\nfirebase.firestore().settings(settings);\n\nfunction logout() {\n  firebase.auth().signOut().then(function () {\n    console.log('Signed Out');\n  }, function (error) {\n    console.error('Sign Out Error', error);\n  });\n}\n\nfunction register(displayName, email, password, onSuccessCallback, onErrorCallback) {\n  firebase.auth().createUserWithEmailAndPassword(email, password).then(function () {\n    var user = firebase.auth().currentUser;\n    user.updateProfile({\n      displayName: '' + displayName\n    }).then(function () {\n      return onSuccessCallback();\n    });\n  }).catch(function (error) {\n    onErrorCallback(error.code, error.message);\n  });\n}\n\nfunction login(user, pass, onSuccessCallback, onErrorCallback) {\n  firebase.auth().signInWithEmailAndPassword(user, pass).then(function () {\n    onSuccessCallback();\n  }).catch(function (error) {\n    console.log('Login error', error);\n    onErrorCallback(error);\n  });\n}\n\nfunction getWebsitesOfUser(callback) {\n  firebase.database().ref('/users/' + firebase.auth().currentUser.uid + '/websites').once('value').then(function (snapshot) {\n    callback(snapshotToArray(snapshot));\n  });\n}\n\nfunction getWebsitesById(id, callback) {\n  firebase.database().ref('/users/' + firebase.auth().currentUser.uid + '/websites/' + id).once('value').then(function (snapshot) {\n    var website = snapshot.val();\n    website.key = snapshot.key;\n    callback(website);\n  });\n}\n\nfunction addWebsite(website, callback) {\n  website.messagesCount = 0;\n  website.formsCount = 0;\n  firebase.database().ref('/users/' + firebase.auth().currentUser.uid + '/websites').push(website).then(callback);\n}\n\nfunction addFormToWebsite(website_id, form, callback) {\n  form.added_on = firebase.database.ServerValue.TIMESTAMP;\n  form.message_count = 0; //don't worry if the keys are very similar.\n\n  var futureFormRef = firebase.database().ref('/users/' + firebase.auth().currentUser.uid + '/websites/' + website_id + \"/forms\").push();\n  form.key = futureFormRef.key;\n  var endpointData = {\n    form: form.key,\n    website: website_id,\n    user: firebase.auth().currentUser.uid\n  };\n  var futureEndpointRef = firebase.database().ref('/endpoints').push();\n  form.endpoint = futureEndpointRef.key;\n  futureFormRef.set(form).then(function (snapshot) {\n    futureEndpointRef.set(endpointData).then(console.log);\n    callback(snapshot);\n  }); // let res = firebase.database().ref('/users/'+firebase.auth().currentUser.uid+'/websites/'+website_id+\"/forms\").push(form).then(callback);\n}\n\nfunction updateForm(websiteId, form_key, update_data, callback) {\n  firebase.database().ref('/users/' + firebase.auth().currentUser.uid + '/websites/' + websiteId + \"/forms/\" + form_key).update(update_data).then(function () {\n    callback();\n  });\n}\n\nfunction deleteForm(websieId, formId, callback) {\n  firebase.database().ref('/users/' + firebase.auth().currentUser.uid + '/websites/' + websieId + '/forms/' + formId).remove().then(function () {\n    callback();\n  }).catch(function (reason) {\n    console.error(reason);\n  });\n}\n\nfunction updateWebsite(update_data, callback) {\n  firebase.database().ref('/users/' + firebase.auth().currentUser.uid + '/websites/' + update_data.key).set(update_data).then(callback);\n}\n\nfunction pullMessages(websiteId, form_id, start_date, end_date, only_valid, callback) {\n  console.log(\"pulling messages\");\n  start_date = new Date(start_date);\n  end_date = new Date(end_date);\n  end_date.setDate(end_date.getDate() + 1);\n  console.log(start_date);\n  console.log(end_date);\n  console.log(firebase.auth().currentUser.uid);\n  var query = firebase.firestore().collection('messages').where('userId', '==', firebase.auth().currentUser.uid).where(\"timestamp\", \"<=\", end_date).where(\"timestamp\", \">=\", start_date).where(\"website_id\", \"==\", websiteId);\n  if (only_valid) query = query.where(\"valid\", \"==\", only_valid);\n  if (form_id != -1) query = query.where(\"formId\", \"==\", form_id);\n  query.get().then(function (snapshot) {\n    var res = snapshot.docs.map(function (doc) {\n      var d = doc.data();\n      d.key = doc.id;\n      return d;\n    });\n    callback(res);\n  });\n}\n\nexport { login, register, getWebsitesOfUser, addWebsite, logout, getWebsitesById, addFormToWebsite, updateForm, deleteForm, updateWebsite, pullMessages };\n\nfunction snapshotToArray(snapshot) {\n  var returnArr = [];\n  console.log(_typeof(snapshot));\n  snapshot.forEach(function (childSnapshot) {\n    var item = childSnapshot.val();\n    item.key = childSnapshot.key;\n    returnArr.push(item);\n  });\n  return returnArr;\n}",{"version":3,"sources":["src\\firebase_api.js"],"names":["firebase","settings","timestampsInSnapshots","config","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","initializeApp","firestore","logout","auth","signOut","then","console","log","error","register","displayName","email","password","onSuccessCallback","onErrorCallback","createUserWithEmailAndPassword","user","currentUser","updateProfile","catch","code","message","login","pass","signInWithEmailAndPassword","getWebsitesOfUser","callback","database","ref","uid","once","snapshot","snapshotToArray","getWebsitesById","id","website","val","key","addWebsite","messagesCount","formsCount","push","addFormToWebsite","website_id","form","added_on","ServerValue","TIMESTAMP","message_count","futureFormRef","endpointData","futureEndpointRef","endpoint","set","updateForm","websiteId","form_key","update_data","update","deleteForm","websieId","formId","remove","reason","updateWebsite","pullMessages","form_id","start_date","end_date","only_valid","Date","setDate","getDate","query","collection","where","get","res","docs","map","doc","d","data","returnArr","forEach","childSnapshot","item"],"mappings":";AAAA,OAAOA,QAAP,MAAqB,UAArB;AACA,OAAO,oBAAP;AAEA,IAAMC,WAAW;AAAC;AAAuBC,yBAAuB;AAA/C,CAAjB;AAGA,IAAIC,SAAS;AACTC,UAAQ,yCADC;AAETC,cAAY,gCAFH;AAGTC,eAAa,uCAHJ;AAITC,aAAW,gBAJF;AAKTC,iBAAe,4BALN;AAMTC,qBAAmB;AANV,CAAb;AASAT,SAASU,aAAT,CAAuBP,MAAvB;AACAH,SAASW,SAAT,GAAqBV,QAArB,CAA8BA,QAA9B;;AAGA,SAASW,MAAT,GAAkB;AACdZ,WAASa,IAAT,GAAgBC,OAAhB,GAA0BC,IAA1B,CAA+B,YAAY;AACvCC,YAAQC,GAAR,CAAY,YAAZ;AACH,GAFD,EAEG,UAAUC,KAAV,EAAiB;AAChBF,YAAQE,KAAR,CAAc,gBAAd,EAAgCA,KAAhC;AACH,GAJD;AAKH;;AAGD,SAASC,QAAT,CAAkBC,WAAlB,EAA+BC,KAA/B,EAAsCC,QAAtC,EAAgDC,iBAAhD,EAAmEC,eAAnE,EAAoF;AAChFxB,WAASa,IAAT,GAAgBY,8BAAhB,CAA+CJ,KAA/C,EAAsDC,QAAtD,EAAgEP,IAAhE,CAAqE,YAAM;AACvE,QAAIW,OAAO1B,SAASa,IAAT,GAAgBc,WAA3B;AACAD,SAAKE,aAAL,CAAmB;AACfR,mBAAa,KAAGA;AADD,KAAnB,EAEGL,IAFH,CAEQ;AAAA,aAAMQ,mBAAN;AAAA,KAFR;AAIH,GAND,EAMGM,KANH,CAMS,UAAUX,KAAV,EAAiB;AACtBM,oBAAgBN,MAAMY,IAAtB,EAA4BZ,MAAMa,OAAlC;AACH,GARD;AASH;;AAGD,SAASC,KAAT,CAAeN,IAAf,EAAqBO,IAArB,EAA0BV,iBAA1B,EAA6CC,eAA7C,EAA8D;AAC1DxB,WAASa,IAAT,GAAgBqB,0BAAhB,CAA2CR,IAA3C,EAAiDO,IAAjD,EAAuDlB,IAAvD,CAA4D,YAAU;AAClEQ;AACH,GAFD,EAEGM,KAFH,CAES,UAAUX,KAAV,EAAiB;AACtBF,YAAQC,GAAR,CAAY,aAAZ,EAA0BC,KAA1B;AACAM,oBAAgBN,KAAhB;AACH,GALD;AAMH;;AAED,SAASiB,iBAAT,CAA2BC,QAA3B,EAAqC;AACjCpC,WAASqC,QAAT,GAAoBC,GAApB,CAAwB,YAAYtC,SAASa,IAAT,GAAgBc,WAAhB,CAA4BY,GAAxC,GAA8C,WAAtE,EAAmFC,IAAnF,CAAwF,OAAxF,EAAiGzB,IAAjG,CAAsG,UAAU0B,QAAV,EAAoB;AACtHL,aAASM,gBAAgBD,QAAhB,CAAT;AACH,GAFD;AAGH;;AAED,SAASE,eAAT,CAAyBC,EAAzB,EAA6BR,QAA7B,EAAuC;AACnCpC,WAASqC,QAAT,GAAoBC,GAApB,CAAwB,YAAYtC,SAASa,IAAT,GAAgBc,WAAhB,CAA4BY,GAAxC,GAA8C,YAA9C,GAA6DK,EAArF,EAAyFJ,IAAzF,CAA8F,OAA9F,EAAuGzB,IAAvG,CAA4G,UAAU0B,QAAV,EAAoB;AAC5H,QAAII,UAAUJ,SAASK,GAAT,EAAd;AACAD,YAAQE,GAAR,GAAcN,SAASM,GAAvB;AACAX,aAASS,OAAT;AACH,GAJD;AAKH;;AAGD,SAASG,UAAT,CAAoBH,OAApB,EAA6BT,QAA7B,EAAuC;AACnCS,UAAQI,aAAR,GAAwB,CAAxB;AACAJ,UAAQK,UAAR,GAAqB,CAArB;AACAlD,WAASqC,QAAT,GAAoBC,GAApB,CAAwB,YAAYtC,SAASa,IAAT,GAAgBc,WAAhB,CAA4BY,GAAxC,GAA8C,WAAtE,EAAmFY,IAAnF,CAAwFN,OAAxF,EAAiG9B,IAAjG,CAAsGqB,QAAtG;AACH;;AAGD,SAASgB,gBAAT,CAA0BC,UAA1B,EAAsCC,IAAtC,EAA4ClB,QAA5C,EAAsD;AAClDkB,OAAKC,QAAL,GAAgBvD,SAASqC,QAAT,CAAkBmB,WAAlB,CAA8BC,SAA9C;AACAH,OAAKI,aAAL,GAAqB,CAArB,CAFkD,CAIlD;;AAEA,MAAIC,gBAAgB3D,SAASqC,QAAT,GAAoBC,GAApB,CAAwB,YAAYtC,SAASa,IAAT,GAAgBc,WAAhB,CAA4BY,GAAxC,GAA8C,YAA9C,GAA6Dc,UAA7D,GAA0E,QAAlG,EAA4GF,IAA5G,EAApB;AACAG,OAAKP,GAAL,GAAWY,cAAcZ,GAAzB;AAEA,MAAIa,eAAe;AAACN,UAAMA,KAAKP,GAAZ;AAAiBF,aAASQ,UAA1B;AAAsC3B,UAAM1B,SAASa,IAAT,GAAgBc,WAAhB,CAA4BY;AAAxE,GAAnB;AACA,MAAIsB,oBAAoB7D,SAASqC,QAAT,GAAoBC,GAApB,CAAwB,YAAxB,EAAsCa,IAAtC,EAAxB;AAEAG,OAAKQ,QAAL,GAAgBD,kBAAkBd,GAAlC;AAEAY,gBAAcI,GAAd,CAAkBT,IAAlB,EAAwBvC,IAAxB,CAA6B,UAAC0B,QAAD,EAAc;AACvCoB,sBAAkBE,GAAlB,CAAsBH,YAAtB,EAAoC7C,IAApC,CAAyCC,QAAQC,GAAjD;AACAmB,aAASK,QAAT;AACH,GAHD,EAdkD,CAmBlD;AACH;;AAED,SAASuB,UAAT,CAAoBC,SAApB,EAA+BC,QAA/B,EAAyCC,WAAzC,EAAsD/B,QAAtD,EAAgE;AAC5DpC,WAASqC,QAAT,GAAoBC,GAApB,CAAwB,YAAYtC,SAASa,IAAT,GAAgBc,WAAhB,CAA4BY,GAAxC,GAA8C,YAA9C,GAA6D0B,SAA7D,GAAyE,SAAzE,GAAqFC,QAA7G,EACKE,MADL,CACYD,WADZ,EACyBpD,IADzB,CAC8B,YAAY;AAEtCqB;AACH,GAJD;AAKH;;AAED,SAASiC,UAAT,CAAoBC,QAApB,EAA8BC,MAA9B,EAAsCnC,QAAtC,EAA+C;AAC3CpC,WAASqC,QAAT,GAAoBC,GAApB,CAAwB,YAAUtC,SAASa,IAAT,GAAgBc,WAAhB,CAA4BY,GAAtC,GAA0C,YAA1C,GAAuD+B,QAAvD,GAAgE,SAAhE,GAA0EC,MAAlG,EAA0GC,MAA1G,GAAmHzD,IAAnH,CAAwH,YAAI;AACxHqB;AACH,GAFD,EAEGP,KAFH,CAES,UAAC4C,MAAD,EAAU;AACfzD,YAAQE,KAAR,CAAcuD,MAAd;AACH,GAJD;AAKH;;AAKD,SAASC,aAAT,CAAuBP,WAAvB,EAAoC/B,QAApC,EAA8C;AAC1CpC,WAASqC,QAAT,GAAoBC,GAApB,CAAwB,YAAYtC,SAASa,IAAT,GAAgBc,WAAhB,CAA4BY,GAAxC,GAA8C,YAA9C,GAA6D4B,YAAYpB,GAAjG,EAAsGgB,GAAtG,CAA0GI,WAA1G,EAAuHpD,IAAvH,CAA4HqB,QAA5H;AACH;;AAGD,SAASuC,YAAT,CAAsBV,SAAtB,EAAiCW,OAAjC,EAA0CC,UAA1C,EAAsDC,QAAtD,EAAgEC,UAAhE,EAA4E3C,QAA5E,EAAsF;AAClFpB,UAAQC,GAAR,CAAY,kBAAZ;AAEA4D,eAAa,IAAIG,IAAJ,CAASH,UAAT,CAAb;AACAC,aAAW,IAAIE,IAAJ,CAASF,QAAT,CAAX;AACAA,WAASG,OAAT,CAAiBH,SAASI,OAAT,KAAqB,CAAtC;AAEAlE,UAAQC,GAAR,CAAY4D,UAAZ;AACA7D,UAAQC,GAAR,CAAY6D,QAAZ;AAEA9D,UAAQC,GAAR,CAAYjB,SAASa,IAAT,GAAgBc,WAAhB,CAA4BY,GAAxC;AACA,MAAI4C,QAAQnF,SAASW,SAAT,GAAqByE,UAArB,CAAgC,UAAhC,EACPC,KADO,CACD,QADC,EACS,IADT,EACerF,SAASa,IAAT,GAAgBc,WAAhB,CAA4BY,GAD3C,EAEP8C,KAFO,CAED,WAFC,EAEY,IAFZ,EAEkBP,QAFlB,EAGPO,KAHO,CAGD,WAHC,EAGY,IAHZ,EAGkBR,UAHlB,EAIPQ,KAJO,CAID,YAJC,EAIa,IAJb,EAImBpB,SAJnB,CAAZ;AAOA,MAAIc,UAAJ,EACII,QAAQA,MAAME,KAAN,CAAY,OAAZ,EAAqB,IAArB,EAA2BN,UAA3B,CAAR;AAGJ,MAAIH,WAAW,CAAC,CAAhB,EACIO,QAAQA,MAAME,KAAN,CAAY,QAAZ,EAAsB,IAAtB,EAA4BT,OAA5B,CAAR;AAEJO,QAAMG,GAAN,GAAYvE,IAAZ,CAAiB,UAAC0B,QAAD,EAAc;AAE3B,QAAI8C,MAAM9C,SAAS+C,IAAT,CAAcC,GAAd,CAAkB,UAACC,GAAD,EAAS;AACjC,UAAIC,IAAID,IAAIE,IAAJ,EAAR;AACAD,QAAE5C,GAAF,GAAQ2C,IAAI9C,EAAZ;AAEA,aAAO+C,CAAP;AACH,KALS,CAAV;AAQAvD,aAASmD,GAAT;AACH,GAXD;AAYH;;AAGD,SACIvD,KADJ,EAEIb,QAFJ,EAGIgB,iBAHJ,EAIIa,UAJJ,EAKIpC,MALJ,EAMI+B,eANJ,EAOIS,gBAPJ,EAQIY,UARJ,EASIK,UATJ,EAUIK,aAVJ,EAWIC,YAXJ;;AAeA,SAASjC,eAAT,CAAyBD,QAAzB,EAAmC;AAC/B,MAAIoD,YAAY,EAAhB;AAEA7E,UAAQC,GAAR,SAAmBwB,QAAnB;AAEAA,WAASqD,OAAT,CAAiB,UAAUC,aAAV,EAAyB;AACtC,QAAIC,OAAOD,cAAcjD,GAAd,EAAX;AACAkD,SAAKjD,GAAL,GAAWgD,cAAchD,GAAzB;AAGA8C,cAAU1C,IAAV,CAAe6C,IAAf;AACH,GAND;AAQA,SAAOH,SAAP;AACH","sourceRoot":"C:\\Users\\Colinear\\Dropbox\\Workspace\\Web\\VueSoStatic\\vue-SoStatic","sourcesContent":["import firebase from 'firebase'\r\nimport 'firebase/firestore';\r\n\r\nconst settings = {/* your settings... */ timestampsInSnapshots: true};\r\n\r\n\r\nlet config = {\r\n    apiKey: \"AIzaSyDOpoNcoeSWE8weaKuT8DvMWt2qSTok11k\",\r\n    authDomain: \"sostatic-1d381.firebaseapp.com\",\r\n    databaseURL: \"https://sostatic-1d381.firebaseio.com\",\r\n    projectId: \"sostatic-1d381\",\r\n    storageBucket: \"sostatic-1d381.appspot.com\",\r\n    messagingSenderId: \"446439468118\"\r\n};\r\n\r\nfirebase.initializeApp(config);\r\nfirebase.firestore().settings(settings);\r\n\r\n\r\nfunction logout() {\r\n    firebase.auth().signOut().then(function () {\r\n        console.log('Signed Out');\r\n    }, function (error) {\r\n        console.error('Sign Out Error', error);\r\n    });\r\n}\r\n\r\n\r\nfunction register(displayName, email, password, onSuccessCallback, onErrorCallback) {\r\n    firebase.auth().createUserWithEmailAndPassword(email, password).then(() => {\r\n        let user = firebase.auth().currentUser;\r\n        user.updateProfile({\r\n            displayName: ''+displayName\r\n        }).then(() => onSuccessCallback())\r\n\r\n    }).catch(function (error) {\r\n        onErrorCallback(error.code, error.message);\r\n    });\r\n}\r\n\r\n\r\nfunction login(user, pass,onSuccessCallback, onErrorCallback) {\r\n    firebase.auth().signInWithEmailAndPassword(user, pass).then(function(){\r\n        onSuccessCallback();\r\n    }).catch(function (error) {\r\n        console.log('Login error',error);\r\n        onErrorCallback(error)\r\n    });\r\n}\r\n\r\nfunction getWebsitesOfUser(callback) {\r\n    firebase.database().ref('/users/' + firebase.auth().currentUser.uid + '/websites').once('value').then(function (snapshot) {\r\n        callback(snapshotToArray(snapshot));\r\n    })\r\n}\r\n\r\nfunction getWebsitesById(id, callback) {\r\n    firebase.database().ref('/users/' + firebase.auth().currentUser.uid + '/websites/' + id).once('value').then(function (snapshot) {\r\n        let website = snapshot.val();\r\n        website.key = snapshot.key;\r\n        callback(website);\r\n    })\r\n}\r\n\r\n\r\nfunction addWebsite(website, callback) {\r\n    website.messagesCount = 0;\r\n    website.formsCount = 0;\r\n    firebase.database().ref('/users/' + firebase.auth().currentUser.uid + '/websites').push(website).then(callback);\r\n}\r\n\r\n\r\nfunction addFormToWebsite(website_id, form, callback) {\r\n    form.added_on = firebase.database.ServerValue.TIMESTAMP;\r\n    form.message_count = 0;\r\n\r\n    //don't worry if the keys are very similar.\r\n\r\n    let futureFormRef = firebase.database().ref('/users/' + firebase.auth().currentUser.uid + '/websites/' + website_id + \"/forms\").push();\r\n    form.key = futureFormRef.key;\r\n\r\n    let endpointData = {form: form.key, website: website_id, user: firebase.auth().currentUser.uid};\r\n    let futureEndpointRef = firebase.database().ref('/endpoints').push();\r\n\r\n    form.endpoint = futureEndpointRef.key;\r\n\r\n    futureFormRef.set(form).then((snapshot) => {\r\n        futureEndpointRef.set(endpointData).then(console.log);\r\n        callback(snapshot);\r\n    });\r\n\r\n    // let res = firebase.database().ref('/users/'+firebase.auth().currentUser.uid+'/websites/'+website_id+\"/forms\").push(form).then(callback);\r\n}\r\n\r\nfunction updateForm(websiteId, form_key, update_data, callback) {\r\n    firebase.database().ref('/users/' + firebase.auth().currentUser.uid + '/websites/' + websiteId + \"/forms/\" + form_key)\r\n        .update(update_data).then(function () {\r\n\r\n        callback();\r\n    });\r\n}\r\n\r\nfunction deleteForm(websieId, formId, callback){\r\n    firebase.database().ref('/users/'+firebase.auth().currentUser.uid+'/websites/'+websieId+'/forms/'+formId).remove().then(()=>{\r\n        callback();\r\n    }).catch((reason)=>{\r\n        console.error(reason);\r\n    })\r\n}\r\n\r\n\r\n\r\n\r\nfunction updateWebsite(update_data, callback) {\r\n    firebase.database().ref('/users/' + firebase.auth().currentUser.uid + '/websites/' + update_data.key).set(update_data).then(callback);\r\n}\r\n\r\n\r\nfunction pullMessages(websiteId, form_id, start_date, end_date, only_valid, callback) {\r\n    console.log(\"pulling messages\");\r\n\r\n    start_date = new Date(start_date);\r\n    end_date = new Date(end_date);\r\n    end_date.setDate(end_date.getDate() + 1);\r\n\r\n    console.log(start_date);\r\n    console.log(end_date);\r\n\r\n    console.log(firebase.auth().currentUser.uid);\r\n    let query = firebase.firestore().collection('messages')\r\n        .where('userId', '==', firebase.auth().currentUser.uid)\r\n        .where(\"timestamp\", \"<=\", end_date)\r\n        .where(\"timestamp\", \">=\", start_date)\r\n        .where(\"website_id\", \"==\", websiteId);\r\n\r\n\r\n    if (only_valid)\r\n        query = query.where(\"valid\", \"==\", only_valid);\r\n\r\n\r\n    if (form_id != -1)\r\n        query = query.where(\"formId\", \"==\", form_id);\r\n\r\n    query.get().then((snapshot) => {\r\n\r\n        let res = snapshot.docs.map((doc) => {\r\n            let d = doc.data();\r\n            d.key = doc.id;\r\n\r\n            return d;\r\n        });\r\n\r\n\r\n        callback(res);\r\n    });\r\n}\r\n\r\n\r\nexport {\r\n    login,\r\n    register,\r\n    getWebsitesOfUser,\r\n    addWebsite,\r\n    logout,\r\n    getWebsitesById,\r\n    addFormToWebsite,\r\n    updateForm,\r\n    deleteForm,\r\n    updateWebsite,\r\n    pullMessages\r\n}\r\n\r\n\r\nfunction snapshotToArray(snapshot) {\r\n    let returnArr = [];\r\n\r\n    console.log(typeof snapshot);\r\n\r\n    snapshot.forEach(function (childSnapshot) {\r\n        let item = childSnapshot.val();\r\n        item.key = childSnapshot.key;\r\n\r\n\r\n        returnArr.push(item);\r\n    });\r\n\r\n    return returnArr;\r\n}"]}]}