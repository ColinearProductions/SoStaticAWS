{"remainingRequest":"C:\\Users\\Razvan\\Dropbox\\SoStaticAWS\\site\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\Razvan\\Dropbox\\SoStaticAWS\\site\\node_modules\\vue-loader\\lib\\selector.js?type=script&index=0!C:\\Users\\Razvan\\Dropbox\\SoStaticAWS\\site\\src\\components\\Messages.vue","dependencies":[{"path":"C:\\Users\\Razvan\\Dropbox\\SoStaticAWS\\site\\src\\components\\Messages.vue","mtime":1552932466617},{"path":"C:\\Users\\Razvan\\Dropbox\\SoStaticAWS\\site\\package.json","mtime":1552761763060},{"path":"C:\\Users\\Razvan\\Dropbox\\SoStaticAWS\\site\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1524914320676},{"path":"C:\\Users\\Razvan\\Dropbox\\SoStaticAWS\\site\\node_modules\\babel-loader\\lib\\index.js","mtime":1519636541000},{"path":"C:\\Users\\Razvan\\Dropbox\\SoStaticAWS\\site\\node_modules\\vue-loader\\lib\\selector.js","mtime":1520395331000}],"contextDependencies":[],"result":["import \"core-js/modules/es7.object.values\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n/* eslint-disable */\nimport moment from 'moment';\nimport zipcelx from 'zipcelx';\nimport * as api from '../firebase_api';\nexport default {\n  name: \"Messages\",\n  data: function data() {\n    return {\n      messages: [],\n      currentMessage: null,\n      startDatePicker: {\n        date: moment().subtract(1, 'months').format(\"YYYY-MM-DD\"),\n        menu: false,\n        modal: false\n      },\n      endDatePicker: {\n        date: moment().format(\"YYYY-MM-DD\"),\n        menu: false,\n        modal: false\n      },\n      selectedForm: -1,\n      onlyValidCheckbox: true,\n      items: [{\n        title: 'Jason Oner',\n        avatar: 'https://cdn.vuetifyjs.com/images/lists/1.jpg'\n      }, {\n        title: 'Travis Howard',\n        avatar: 'https://cdn.vuetifyjs.com/images/lists/2.jpg'\n      }, {\n        title: 'Ali Connors',\n        avatar: 'https://cdn.vuetifyjs.com/images/lists/3.jpg'\n      }, {\n        title: 'Cindy Baker',\n        avatar: 'https://cdn.vuetifyjs.com/images/lists/4.jpg'\n      }]\n    };\n  },\n  computed: {\n    listOfForms: function listOfForms() {\n      console.log('*******', this.currentWebsite.forms);\n      var res = [];\n      res.push({\n        'id': -1,\n        'alias': 'All'\n      });\n      if (this.currentWebsite.forms === undefined) return res;\n      var formsList = Object.values(this.currentWebsite.forms);\n\n      for (var i = 0; i < formsList.length; i++) {\n        res.push({\n          'id': formsList[i].key,\n          'alias': formsList[i].alias\n        });\n      }\n\n      return res;\n    },\n    currentWebsite: function currentWebsite() {\n      return this.$store.getters.currentWebsite;\n    }\n  },\n  methods: {\n    onDownloadPressed: function onDownloadPressed() {\n      api.pullMessages(this.currentWebsite.key, this.selectedForm, this.startDatePicker.date, this.endDatePicker.date, this.onlyValidCheckbox, function (res) {\n        download(JSON.stringify(res, null, \"\\t\"), 'messages.json', 'text/plain');\n      });\n    },\n    highlightMessage: function highlightMessage(message) {\n      if (message.highlight) {\n        message.highlight = false;\n        return;\n      }\n\n      this.messages.forEach(function (message) {\n        message.highlight = false;\n      });\n      message.highlight = !message.highlight;\n    }\n  },\n  watch: {\n    'currentWebsite': function currentWebsite() {\n      var that = this;\n      api.pullMessages(this.currentWebsite.key, this.selectedForm, 0, 99999999999999, this.onlyValidCheckbox, function (res) {\n        console.log(res);\n        that.messages = res.map(function (message) {\n          var payload = message.payload;\n          message.highlight = false;\n          message.card = {\n            title: payload[Object.keys(payload)[0]],\n            subtitle: payload[Object.keys(payload)[1]],\n            time: moment.unix(message.timestamp / 1000).format(\"LL\")\n          };\n          message.properties = Object.keys(message.payload);\n          return message;\n        });\n      });\n    }\n  }\n};\n\nfunction download(content, fileName, contentType) {\n  var a = document.createElement(\"a\");\n  var file = new Blob([content], {\n    type: contentType\n  });\n  a.href = URL.createObjectURL(file);\n  a.download = fileName;\n  a.click();\n}",{"version":3,"sources":["Messages.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmKA;AACA;AACA;AACA;AAGA;QAEA;wBACA;;gBAEA;sBACA;;oDAEA;cACA;eACA,AACA;AAJA;;8BAMA;cACA;eACA,AACA;AAJA;qBAKA;yBACA;;;gBAEA;OADA;;gBAEA;;;gBACA;;;gBAEA,AAGA,AACA;;AAxBA;AAyBA,AACA;;wCAEA;iDACA;gBACA;;;iBAEA;;wCACA,kBACA;wDAEA;;iDACA;;;gCACA;;AAGA;;aAEA;AACA,AACA;8CACA;iCACA;AACA,AACA,AACA;AAvBA;;oDA2BA;8JACA;mEACA;AAGA;AACA;yDAEA;6BACA;4BACA;AACA;AACA;;+CACA;4BACA;AACA;mCACA;AACA,AACA;AArBA;;gDAuBA;iBACA;6HACA;oBAGA;mDACA;gCACA;8BACA;;gDAEA;mDACA;+DACA,AACA;AAJA;mDAKA;iBACA;AACA;AACA;AACA,AACA;AApBA;AA5EA;;AAkGA,kDACA;iCACA;;UACA;;+BACA;eACA;IACA","file":"Messages.vue","sourceRoot":"src\\components","sourcesContent":["<template>\r\n\r\n    <v-layout row wrap>\r\n\r\n\r\n        <v-flex xs8 offset-md2>\r\n            <v-flex xs12 class=\"pa-0 pb-3\">\r\n                <v-card>\r\n                    <v-flex>\r\n                        <v-layout>\r\n                            <v-flex md3 d-flex>\r\n                                <v-select\r\n                                        :items=\"listOfForms\"\r\n                                        item-text=\"alias\"\r\n                                        item-value=\"id\"\r\n                                        v-model=\"selectedForm\"\r\n                                        label=\"Form\"\r\n\r\n                                ></v-select>\r\n                            </v-flex>\r\n                            <v-flex md3 d-flex>\r\n                                <v-menu\r\n                                        ref=\"startDatePicker\"\r\n                                        :close-on-content-click=\"false\"\r\n                                        v-model=\"startDatePicker.menu\"\r\n                                        :nudge-right=\"40\"\r\n                                        :return-value.sync=\"startDatePicker.date\"\r\n                                        lazy\r\n                                        transition=\"scale-transition\"\r\n                                        offset-y\r\n                                        full-width\r\n                                        min-width=\"290px\"\r\n                                >\r\n                                    <v-text-field\r\n                                            slot=\"activator\"\r\n                                            v-model=\"startDatePicker.date\"\r\n                                            label=\"Starting from\"\r\n                                            prepend-icon=\"event\"\r\n                                            readonly\r\n                                    ></v-text-field>\r\n                                    <v-date-picker v-model=\"startDatePicker.date\" no-title scrollable>\r\n                                        <v-spacer></v-spacer>\r\n                                        <v-btn flat color=\"primary\" @click=\"startDatePicker.menu = false\">Cancel</v-btn>\r\n                                        <v-btn flat color=\"primary\"\r\n                                               @click=\"$refs.startDatePicker.save(startDatePicker.date)\">OK\r\n                                        </v-btn>\r\n                                    </v-date-picker>\r\n                                </v-menu>\r\n                            </v-flex>\r\n                            <v-flex md3 d-flex>\r\n                                <v-menu\r\n                                        ref=\"endDatePicker\"\r\n                                        :close-on-content-click=\"false\"\r\n                                        v-model=\"endDatePicker.menu\"\r\n                                        :nudge-right=\"40\"\r\n                                        :return-value.sync=\"endDatePicker.date\"\r\n                                        lazy\r\n                                        transition=\"scale-transition\"\r\n                                        offset-y\r\n                                        full-width\r\n                                        min-width=\"290px\"\r\n                                >\r\n                                    <v-text-field\r\n                                            slot=\"activator\"\r\n                                            v-model=\"endDatePicker.date\"\r\n                                            label=\"Until\"\r\n                                            prepend-icon=\"event\"\r\n                                            readonly\r\n                                    ></v-text-field>\r\n                                    <v-date-picker v-model=\"endDatePicker.date\" no-title scrollable>\r\n                                        <v-spacer></v-spacer>\r\n                                        <v-btn flat color=\"primary\" @click=\"endDatePicker.menu = false\">Cancel</v-btn>\r\n                                        <v-btn flat color=\"primary\"\r\n                                               @click=\"$refs.endDatePicker.save(endDatePicker.date)\">OK\r\n                                        </v-btn>\r\n                                    </v-date-picker>\r\n                                </v-menu>\r\n                            </v-flex>\r\n                            <v-flex md2 d-flex>\r\n                                <v-checkbox\r\n                                        label=\"Only valid\"\r\n                                        v-model=\"onlyValidCheckbox\"\r\n                                ></v-checkbox>\r\n                            </v-flex>\r\n                            <v-flex md3 d-flex>\r\n                                <v-btn depressed color=\"primary lighten-1\" @click=\"onDownloadPressed\" class=\"pr-3\">\r\n                                    <v-icon dark class=\"pr-3\">cloud_download</v-icon>\r\n                                    Download\r\n                                </v-btn>\r\n\r\n                            </v-flex>\r\n                        </v-layout>\r\n                    </v-flex>\r\n                </v-card>\r\n\r\n            </v-flex>\r\n            <v-card class=\"pa-3 fill-height\">\r\n                <v-layout row wrap>\r\n                    <v-flex xs12 fill-height>\r\n                        <p class=\"title pl-3\">Messages </p>\r\n\r\n\r\n                        <v-list>\r\n                            <v-card v-for=\"(message,index) in messages\" :key=\"index\" flat class=\"my-2\"  style=\"border:1px solid rgb(230, 230, 230)\">\r\n                                <v-list-tile @click=\"highlightMessage(message)\"\r\n                                             v-bind:class=\"{'v-list__tile--highlighted':message.highlight}\">\r\n\r\n\r\n                                    <v-list-tile-content>\r\n                                        <v-list-tile-title v-text=\"message.card.title\"></v-list-tile-title>\r\n                                        <v-list-tile-sub-title>{{message.card.subtitle}}</v-list-tile-sub-title>\r\n\r\n                                    </v-list-tile-content>\r\n                                    <v-list-tile-action>\r\n                                        <v-list-tile-action-text>{{message.card.time}}</v-list-tile-action-text>\r\n                                    </v-list-tile-action>\r\n                                    <v-icon>{{message.highlight?'expand_more':'expand_less'}}</v-icon>\r\n\r\n\r\n\r\n                                </v-list-tile>\r\n\r\n                                <v-card class=\"pb-3 pt-3 mb-4\" flat v-if=\"message.highlight\" >\r\n\r\n                                    <v-flex xs12class=\"pa-3\">\r\n                                        <v-layout row v-for=\"(property,index) in message.properties\" wrap class=\"py-1\">\r\n\r\n                                            <v-flex xs2 class=\"py-0\">\r\n                                                <p class=\"text-capitalize my-0 grey--text \">{{property}}:</p>\r\n                                            </v-flex>\r\n                                            <v-flex xs10 class=\"py-0 \">\r\n                                                <p class=\"align-end  my-0 text-lg-right subheading\">\r\n                                                    {{message.payload[property]}}</p>\r\n                                            </v-flex>\r\n                                            <v-flex xs112 class=\"py-0\" v-if=\"index<message.properties.length-1\">\r\n                                                <v-divider></v-divider>\r\n                                            </v-flex>\r\n\r\n                                        </v-layout>\r\n\r\n\r\n                                    </v-flex>\r\n\r\n\r\n                                </v-card>\r\n\r\n\r\n                            </v-card>\r\n                        </v-list>\r\n\r\n\r\n                    </v-flex>\r\n\r\n\r\n                </v-layout>\r\n            </v-card>\r\n        </v-flex>\r\n    </v-layout>\r\n\r\n\r\n</template>\r\n\r\n<script>\r\n    /* eslint-disable */\r\n    import moment from 'moment'\r\n    import zipcelx from 'zipcelx'\r\n    import * as api from '../firebase_api';\r\n\r\n\r\n    export default {\r\n        name: \"Messages\",\r\n        data: function () {\r\n            return {\r\n                messages: [],\r\n                currentMessage: null,\r\n                startDatePicker: {\r\n                    date: moment().subtract(1, 'months').format(\"YYYY-MM-DD\"),\r\n                    menu: false,\r\n                    modal: false\r\n                },\r\n                endDatePicker: {\r\n                    date: moment().format(\"YYYY-MM-DD\"),\r\n                    menu: false,\r\n                    modal: false\r\n                },\r\n                selectedForm: -1,\r\n                onlyValidCheckbox: true,\r\n                items: [\r\n                    {title: 'Jason Oner', avatar: 'https://cdn.vuetifyjs.com/images/lists/1.jpg'},\r\n                    {title: 'Travis Howard', avatar: 'https://cdn.vuetifyjs.com/images/lists/2.jpg'},\r\n                    {title: 'Ali Connors', avatar: 'https://cdn.vuetifyjs.com/images/lists/3.jpg'},\r\n                    {title: 'Cindy Baker', avatar: 'https://cdn.vuetifyjs.com/images/lists/4.jpg'},\r\n\r\n                ]\r\n\r\n\r\n            }\r\n        }\r\n        ,\r\n        computed: {\r\n            listOfForms: function () {\r\n                console.log('*******', this.currentWebsite.forms);\r\n                let res = [];\r\n                res.push({'id': -1, 'alias': 'All'});\r\n\r\n                if (this.currentWebsite.forms === undefined)\r\n                    return res;\r\n                let formsList = Object.values(this.currentWebsite.forms);\r\n\r\n                for (let i = 0; i < formsList.length; i++) {\r\n                    res.push({'id': formsList[i].key, 'alias': formsList[i].alias})\r\n                }\r\n\r\n\r\n                return res;\r\n\r\n            }\r\n            ,\r\n            currentWebsite: function () {\r\n                return this.$store.getters.currentWebsite;\r\n            }\r\n        }\r\n        ,\r\n        methods: {\r\n            onDownloadPressed: function () {\r\n\r\n\r\n                api.pullMessages(this.currentWebsite.key, this.selectedForm, this.startDatePicker.date, this.endDatePicker.date, this.onlyValidCheckbox, function (res) {\r\n                    download(JSON.stringify(res, null, \"\\t\"), 'messages.json', 'text/plain');\r\n                });\r\n\r\n\r\n            },\r\n            highlightMessage: function (message) {\r\n\r\n                if(message.highlight){\r\n                    message.highlight=false;\r\n                    return;\r\n                }\r\n                this.messages.forEach((message) => {\r\n                    message.highlight = false;\r\n                });\r\n                message.highlight = !message.highlight;\r\n            }\r\n        },\r\n        watch: {\r\n            'currentWebsite': function () {\r\n                let that = this;\r\n                api.pullMessages(this.currentWebsite.key, this.selectedForm, 0, 99999999999999, this.onlyValidCheckbox, function (res) {\r\n                    console.log(res);\r\n\r\n\r\n                    that.messages = res.map((message) => {\r\n                        let payload = message.payload;\r\n                        message.highlight = false;\r\n                        message.card = {\r\n                            title: payload[Object.keys(payload)[0]],\r\n                            subtitle: payload[Object.keys(payload)[1]],\r\n                            time: moment.unix(message.timestamp / 1000).format(\"LL\")\r\n                        };\r\n                        message.properties = Object.keys(message.payload);\r\n                        return message;\r\n                    });\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    function download(content, fileName, contentType) {\r\n        let a = document.createElement(\"a\");\r\n        let file = new Blob([content], {type: contentType});\r\n        a.href = URL.createObjectURL(file);\r\n        a.download = fileName;\r\n        a.click();\r\n    }\r\n\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>"]}]}